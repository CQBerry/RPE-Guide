# 🌟 批量编辑进阶

在本章您将会学习对于音符以及事件的高级批量编辑。

让我们在编辑音符区放置一些 $X$ 坐标为 0 的 Tap 音符，多选这些 Tap 音符，功能区出现 ***多音符编辑***。

![多音符编辑](/assets/imgs/contents/多音符编辑.avif)

- 选择数值种类（可为 X/Speed/Size/YOffset/VisibleTime）；
- 填入数值下界、数值上界、缓动类型、周期数列和扰动；
- 选择修改方式（By/To/Times/Max/Min），点击应用以进行批量修改。

下面介绍修改的具体流程：

编辑器会按时间顺序修改选中的每个音符，如果共有 $N$ 个音符被选中，我们处理到了第 $n$ 个音符。我们考虑一个起始坐标 $(0, 0)$，结束坐标 $(1, 1)$ 的缓动曲线。曲线的类型由填入的缓动类型确定（关于缓动类型，请参阅 [处理事件](../basis/charting/handle-events.md)），编辑器会取出直线 $X=\frac{n-1}{N-1}$ 与曲线交点的 $Y$ 坐标 $Y∈[0, 1]$ 之后，算出基础数值 $X_n=(数值上界 - 数值下界)\times Y+ 数值下界$，加上在 $[-|扰动|， +|扰动|]$ 间的随机数值，再乘以周期数列（若干浮点数，从 0 编号）中 $n$ 模数列长度位置处的数列值，得到修改数值 $Z_n$。

如果修改方式为 By，则将该音符数值种类的值 $x$ 修改为 $x+Z_n$，若方式为 To，则修改为 $Z_n$，若方式为 Times，
则修改为 $x\times Z_n$，若方式为 Max/Min，则修改为 $Max/Min(x, Z_n)$。

举例来说，若开始 5 个音符的 $X$ 坐标为 $0$，取数值下界为 $-400$，上界为 $400$，缓动类型为 1，周期数列为 {1,-1}，扰动为 0，修改方式为 By，则会得到 $X = {0, 100, -200, 300, -400}$ 这 5 个坐标的音符，如果将扰动取为 $30$，则最后一个 $X$ 坐标的范围在 $[-370,430]$ 之间。恢复扰动为 0，再次按下应用，则得到 $X = {0, 200, -400, 600, -800}$，因为修改方式为 By 型加值，如果此时改为 To 型修改再按下应用则得到 $X = {0, 100, -200, 300, -400}$。

下面看几个简单的应用：

![多音符编辑应用 1](/assets/imgs/contents/多音符编辑应用1.avif)

![多音符编辑应用 2](/assets/imgs/contents/多音符编辑应用2.avif)

批量修改音符的 YOffset 可以快速地生成类似 Palescreen 的扫描线键型。

事件也有相同的批量修改，可以修改的数值种类为事件的初始状态，结束状态或者缓动类型，多选事件后粘合将从前至后对每个事件进行粘合操作。

不同的是，事件多选编辑要求操作一个种类的事件，如果选中的就是同一类事件的话，就会自动填入种类，否则需要手动更改为想修改的事件类型。

举例：怎么做出若干组判定线 $X$ 坐标绕 0 正弦振动，幅度逐渐增大的 MoveX 事件？

先拉出若干 MoveX 事件，之后对它们进行批量编辑：下界 $0$、上界 $500$、缓动 1、周期 $0, 1, 0, -1$、扰动 $0$，修改类型 End，修改方式 To，点击应用，点击粘合，我们得到了幅度逐渐增大的线性移动。

更改数值上下界为 $2$，周期数列为 $1.5, 1$ 修改类型为 Easing，点击应用，我们就得到了若干幅度逐渐增大的正弦振动。

事件克隆：点击多事件编辑下的“克隆”栏：

![多事件克隆](/assets/imgs/contents/多事件克隆.avif)

事件克隆的目的是将若干事件以一定的规律依次有修改的复制到若干条判定线上。线号序列要求输入若干整数，表示复制到的判定线的编号，复制的时候编辑器也是依次操作的，类比于之前按照音符的时间顺序记为 $n$，这里会按照线号序列的顺序也记为 $n$。

上下缓扰：数值下界、数值上界、缓动类型、扰动的缩写，时间增量指每处理一条线将所有事件的时间整体向后平移的横线数，修改类型相当于只有 By 型。

下图为一简单的效果，还有比较简单且常用的效果是线等距排布，依次浮现并慢慢消失，用克隆只需要 1 步。

![事件克隆应用 1](/assets/imgs/contents/事件克隆应用1.avif)

这里我给了 0 号线一个上下正弦振动，然后克隆到了 0~10 号线上。

:::warning
克隆可以保留源（默认不保留），保留源且克隆包括这条线的话可能会导致事件重叠。
:::
